@model Application.DTOs.DeliveryRequestDTOs.DeliveryRequestDto
@using Domain.Enums

@{
    ViewData["Title"] = "Sipariş Detayı";
}

<h2 class="mb-4">Sipariş Detayı (#@Model.Id)</h2>

<div class="card mb-4">
    <div class="card-body">
        <div class="row g-3">
            <div class="col-md-4">
                <b>Liste:</b> @Model.ListName
            </div>
            <div class="col-md-4">
                <b>Teslimat Tarihi:</b> @Model.DeliveryDate.ToString("dd.MM.yyyy")
            </div>
            <div class="col-md-4">
                <b>Durum:</b>
                @switch (Model.Status)
                {
                    case DeliveryStatus.Pending:
                        <span class="badge bg-secondary">Bekliyor</span>
                        break;
                    case DeliveryStatus.Prepared:
                        <span class="badge bg-warning text-dark">Hazırlandı</span>
                        break;
                    case DeliveryStatus.Shipped:
                        <span class="badge bg-info text-dark">Kuryede</span>
                        break;
                    case DeliveryStatus.Delivered:
                        <span class="badge bg-primary">Teslim Edildi</span>
                        break;
                    case DeliveryStatus.Completed:
                        <span class="badge bg-success">Tamamlandı</span>
                        break;
                    case DeliveryStatus.Cancelled:
                        <span class="badge bg-danger">İptal</span>
                        break;
                    default:
                        <span class="badge bg-dark">Bilinmiyor</span>
                        break;
                }
            </div>
        </div>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header"><b>Sipariş İçeriği</b></div>
    <div class="card-body p-0">
        @if (Model.Items == null || !Model.Items.Any())
        {
            <div class="p-3">Bu siparişe ait film bulunamadı.</div>
        }
        else
        {
            <table class="table table-bordered mb-0 align-middle">
                <thead class="table-dark">
                    <tr>
                        <th style="width:80px;">#</th>
                        <th>Film</th>
                        <th style="width:140px;">İade</th>
                        <th style="width:140px;">Hasar</th>
                        <th style="width:180px;">İade Tarihi</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var it in Model.Items)
                    {
                        <tr>
                            <td>@it.Id</td>
                            <td>@(it.MovieTitle ?? "-")</td>
                            <td>
                                @if (it.IsReturned)
                                {
                                    <span class="badge bg-success">İade edildi</span>
                                }
                                else
                                {
                                    <span class="badge bg-secondary">Bekliyor</span>
                                }
                            </td>
                            <td>
                                @if (it.IsDamaged)
                                {
                                    <span class="badge bg-danger">Hasarlı</span>
                                }
                                else
                                {
                                    <span class="badge bg-success">Sağlam</span>
                                }
                            </td>
                            <td>@(it.ReturnDate?.ToString("dd.MM.yyyy HH:mm") ?? "-")</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
</div>

<div class="d-flex gap-2">
    <a asp-action="Index" class="btn btn-outline-secondary">
        Geri
    </a>
</div>
